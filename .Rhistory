library(tidyverse); library(survey)
load("banco_completo.Rdata")
vigitel <- combined_data |> select(c(ano, cidade, fesc, q6, q7, civil, q8a, q8b, q8_anos,
r128a, q9, q11, q42, q43a, q44, q45, q46, q47, q48,
q49, r147, r148_hh, r148_mm, q50, q51, q52, q53, q54,
q55, q56, r149, r150_hh, r150_mm, q59a, q59b, q59c, q60, pesorake))
save(combined_data_lite, file="banco_reduzido.Rdata")
save(vigitel, file="banco_reduzido.Rdata")
load("banco_reduzido.Rdata")
vigitel <- vigitel |> mutate(id = 1:nrow(vigitel),
q51_cont = if_else(q50 == "3", 0, q51),
q54_cont = if_else(q53 == "3", 0, q51),
q51_cont = case_when(q51_cont == 1 ~ 0,
q51_cont == 2 ~ 10,
q51_cont == 3 ~ 20,
q51_cont == 4 ~ 30,
q51_cont == 5 ~ 40,
q51_cont == 6 ~ 50,
q51_cont == 7 ~ 60,
q51_cont == 0 ~ 0),
q54_cont = case_when(q54_cont == 1 ~ 0,
q54_cont == 2 ~ 10,
q54_cont == 3 ~ 20,
q54_cont == 4 ~ 30,
q54_cont == 5 ~ 40,
q54_cont == 6 ~ 50,
q54_cont == 7 ~ 60,
q54_cont == 0 ~ 0),
min_desloc_cont = q51_cont + q54_cont,
q51_factor = ordered(q51, levels=c("1", "2", "3", "4", "5",
"6", "7")))
vigi_design <- svydesign(id = ~ 1,
strata = NULL,
weights= ~ pesorake,
data=vigitel)
m1 <- svyglm(q51_cont ~ ano * q7 + q6, design=vigi_design)
summary(m1)
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7"))
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres")) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c(1 = "Homens",
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c(1 = "Homens",
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres")) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("Homens", "Mulheres")) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("Homens", "Mulheres")) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres"),
values=c("yellow", "green")) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres"),
values=c("darkblue", "orange")) +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres"),
values=c("darkblue", "orange")) +
labs(x="Anos", y="Tempo de deslocamento diário ao trabalho") +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_pointrange() +
geom_line() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres"),
values=c("darkblue", "orange")) +
labs(x="Anos", y="Tempo de deslocamento diário ao trabalho") +
theme_bw()
ggeffects::ggpredict(m1, terms=c("ano [all]", "q7")) |> as_tibble() |>
ggplot(aes(x=x, y=predicted, ymin=conf.low, ymax=conf.high, color=group)) +
geom_line() +
geom_pointrange() +
scale_x_continuous(breaks=seq(2009, 2022, 1)) +
scale_color_manual(labels=c("1" = "Homens",
"2" = "Mulheres"),
values=c("darkblue", "orange")) +
labs(x="Anos", y="Tempo de deslocamento diário ao trabalho") +
theme_bw()
